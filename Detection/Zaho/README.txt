this code is mainly from Bo Zaho from univsersity of washington :source code can been found here :  https://figshare.com/s/eeedcd150e759ef4353c under GPL3+ licence
the original autor have no responsability in this work.
Minor modification as beendone
